[----------] 2 tests from CodecTest
[ RUN      ] CodecTest.EncryptionVerification
[2024-12-28 01:52:50.072422] [0x00007f727aa09fc0] [info] Setting up CodecTest fixture
[2024-12-28 01:52:50.072771] [0x00007f727aa09fc0] [debug] Test fixture initialized with key size: 32
[2024-12-28 01:52:50.073036] [0x00007f727aa09fc0] [info] Starting EncryptionVerification test
[2024-12-28 01:52:50.073287] [0x00007f727aa09fc0] [debug] Creating test frame with payload size: 14
[2024-12-28 01:52:50.073623] [0x00007f727aa09fc0] [debug] Test frame created with type: 0
[2024-12-28 01:52:50.073904] [0x00007f727aa09fc0] [info] Initializing CryptoStream
[2024-12-28 01:52:50.074319] [0x00007f727aa09fc0] [debug] CryptoStream initialization complete
[2024-12-28 01:52:50.074917] [0x00007f727aa09fc0] [info] Initializing crypto parameters
[2024-12-28 01:52:50.075171] [0x00007f727aa09fc0] [debug] Crypto parameters initialized successfully
[2024-12-28 01:52:50.075543] [0x00007f727aa09fc0] [info] Starting stream encryption
[2024-12-28 01:52:50.076078] [0x00007f727aa09fc0] [debug] Initializing cipher for encryption
[2024-12-28 01:52:50.078248] [0x00007f727aa09fc0] [debug] Cipher initialization complete
[2024-12-28 01:52:50.078629] [0x00007f727aa09fc0] [info] Initializing CryptoStream
[2024-12-28 01:52:50.078900] [0x00007f727aa09fc0] [debug] CryptoStream initialization complete
[2024-12-28 01:52:50.079222] [0x00007f727aa09fc0] [info] Initializing crypto parameters
[2024-12-28 01:52:50.079864] [0x00007f727aa09fc0] [debug] Crypto parameters initialized successfully
[2024-12-28 01:52:50.080385] [0x00007f727aa09fc0] [info] Starting stream encryption
[2024-12-28 01:52:50.080856] [0x00007f727aa09fc0] [debug] Initializing cipher for encryption
[2024-12-28 01:52:50.081131] [0x00007f727aa09fc0] [debug] Cipher initialization complete
[2024-12-28 01:52:50.081502] [0x00007f727aa09fc0] [debug] Cleaning up CryptoStream resources
[2024-12-28 01:52:50.081888] [0x00007f727aa09fc0] [debug] Cleaning up CryptoStream resources
[2024-12-28 01:52:50.082158] [0x00007f727aa09fc0] [debug] Serialized data size: 61
[2024-12-28 01:52:50.082538] [0x00007f727aa09fc0] [debug] Verified sensitive data is not in plain text
[2024-12-28 01:52:50.082847] [0x00007f727aa09fc0] [info] Initializing CryptoStream
[2024-12-28 01:52:50.084266] [0x00007f727aa09fc0] [debug] CryptoStream initialization complete
[2024-12-28 01:52:50.084773] [0x00007f727aa09fc0] [info] Initializing crypto parameters
[2024-12-28 01:52:50.085099] [0x00007f727aa09fc0] [debug] Crypto parameters initialized successfully
[2024-12-28 01:52:50.085434] [0x00007f727aa09fc0] [info] Starting stream decryption
[2024-12-28 01:52:50.085747] [0x00007f727aa09fc0] [debug] Initializing cipher for decryption
[2024-12-28 01:52:50.086238] [0x00007f727aa09fc0] [debug] Cipher initialization complete
[2024-12-28 01:52:50.086448] [0x00007f727aa09fc0] [info] Initializing CryptoStream
[2024-12-28 01:52:50.086464] [0x00007f727aa09fc0] [debug] CryptoStream initialization complete
[2024-12-28 01:52:50.086470] [0x00007f727aa09fc0] [info] Initializing crypto parameters
[2024-12-28 01:52:50.086479] [0x00007f727aa09fc0] [debug] Crypto parameters initialized successfully
[2024-12-28 01:52:50.086489] [0x00007f727aa09fc0] [info] Starting stream decryption
[2024-12-28 01:52:50.086498] [0x00007f727aa09fc0] [debug] Initializing cipher for decryption
[2024-12-28 01:52:50.086507] [0x00007f727aa09fc0] [debug] Cipher initialization complete
[2024-12-28 01:52:50.086518] [0x00007f727aa09fc0] [debug] Cleaning up CryptoStream resources
[2024-12-28 01:52:50.086530] [0x00007f727aa09fc0] [debug] Added message frame to channel. Channel size: 1
[2024-12-28 01:52:50.086556] [0x00007f727aa09fc0] [debug] Cleaning up CryptoStream resources
[2024-12-28 01:52:50.086567] [0x00007f727aa09fc0] [debug] Recovered payload size: 14
/home/runner/StreamCryptoDFS/src/tests/codec_test.cpp:153: Failure
Expected equality of these values:
  recovered_payload
    Which is: "\0\0\0\0\0\0\0\0\0\0\0\0\0\0"
  "Sensitive Data"

[2024-12-28 01:52:50.086623] [0x00007f727aa09fc0] [info] EncryptionVerification test completed successfully
[2024-12-28 01:52:50.086636] [0x00007f727aa09fc0] [debug] Tearing down CodecTest fixture
[  FAILED  ] CodecTest.EncryptionVerification (14 ms)
[ RUN      ] CodecTest.LargeMessageHandling
[2024-12-28 01:52:50.086679] [0x00007f727aa09fc0] [info] Setting up CodecTest fixture
[2024-12-28 01:52:50.086679] [0x00007f727aa09fc0] [info] Setting up CodecTest fixture
[2024-12-28 01:52:50.086703] [0x00007f727aa09fc0] [debug] Test fixture initialized with key size: 32
[2024-12-28 01:52:50.086703] [0x00007f727aa09fc0] [debug] Test fixture initialized with key size: 32
[2024-12-28 01:52:50.086722] [0x00007f727aa09fc0] [info] Starting LargeMessageHandling test
[2024-12-28 01:52:50.086722] [0x00007f727aa09fc0] [info] Starting LargeMessageHandling test
[2024-12-28 01:52:50.089314] [0x00007f727aa09fc0] [debug] Created large payload of size: 1048576
[2024-12-28 01:52:50.089314] [0x00007f727aa09fc0] [debug] Created large payload of size: 1048576
[2024-12-28 01:52:50.089349] [0x00007f727aa09fc0] [debug] Creating test frame with payload size: 1048576
[2024-12-28 01:52:50.089349] [0x00007f727aa09fc0] [debug] Creating test frame with payload size: 1048576
[2024-12-28 01:52:50.089898] [0x00007f727aa09fc0] [debug] Test frame created with type: 0
[2024-12-28 01:52:50.089898] [0x00007f727aa09fc0] [debug] Test frame created with type: 0
[2024-12-28 01:52:50.089927] [0x00007f727aa09fc0] [info] Initializing CryptoStream
[2024-12-28 01:52:50.089927] [0x00007f727aa09fc0] [info] Initializing CryptoStream
[2024-12-28 01:52:50.090017] [0x00007f727aa09fc0] [debug] CryptoStream initialization complete
[2024-12-28 01:52:50.090017] [0x00007f727aa09fc0] [debug] CryptoStream initialization complete
[2024-12-28 01:52:50.090030] [0x00007f727aa09fc0] [info] Initializing crypto parameters
[2024-12-28 01:52:50.090030] [0x00007f727aa09fc0] [info] Initializing crypto parameters
[2024-12-28 01:52:50.090038] [0x00007f727aa09fc0] [debug] Crypto parameters initialized successfully
[2024-12-28 01:52:50.090038] [0x00007f727aa09fc0] [debug] Crypto parameters initialized successfully
[2024-12-28 01:52:50.090067] [0x00007f727aa09fc0] [info] Starting stream encryption
[2024-12-28 01:52:50.090067] [0x00007f727aa09fc0] [info] Starting stream encryption
[2024-12-28 01:52:50.090093] [0x00007f727aa09fc0] [debug] Initializing cipher for encryption
[2024-12-28 01:52:50.090093] [0x00007f727aa09fc0] [debug] Initializing cipher for encryption
[2024-12-28 01:52:50.090130] [0x00007f727aa09fc0] [debug] Cipher initialization complete
[2024-12-28 01:52:50.090130] [0x00007f727aa09fc0] [debug] Cipher initialization complete
[2024-12-28 01:52:50.090725] [0x00007f727aa09fc0] [info] Initializing CryptoStream
[2024-12-28 01:52:50.090725] [0x00007f727aa09fc0] [info] Initializing CryptoStream
[2024-12-28 01:52:50.090775] [0x00007f727aa09fc0] [debug] CryptoStream initialization complete
[2024-12-28 01:52:50.090775] [0x00007f727aa09fc0] [debug] CryptoStream initialization complete
[2024-12-28 01:52:50.090806] [0x00007f727aa09fc0] [info] Initializing crypto parameters
[2024-12-28 01:52:50.090806] [0x00007f727aa09fc0] [info] Initializing crypto parameters
[2024-12-28 01:52:50.090835] [0x00007f727aa09fc0] [debug] Crypto parameters initialized successfully
[2024-12-28 01:52:50.090835] [0x00007f727aa09fc0] [debug] Crypto parameters initialized successfully
[2024-12-28 01:52:50.091821] [0x00007f727aa09fc0] [info] Starting stream encryption
[2024-12-28 01:52:50.091821] [0x00007f727aa09fc0] [info] Starting stream encryption
[2024-12-28 01:52:50.094438] [0x00007f727aa09fc0] [debug] Initializing cipher for encryption
[2024-12-28 01:52:50.094438] [0x00007f727aa09fc0] [debug] Initializing cipher for encryption
[2024-12-28 01:52:50.094502] [0x00007f727aa09fc0] [debug] Cipher initialization complete
[2024-12-28 01:52:50.094502] [0x00007f727aa09fc0] [debug] Cipher initialization complete
[2024-12-28 01:52:50.100630] [0x00007f727aa09fc0] [debug] Cleaning up CryptoStream resources
[2024-12-28 01:52:50.100630] [0x00007f727aa09fc0] [debug] Cleaning up CryptoStream resources
[2024-12-28 01:52:50.100808] [0x00007f727aa09fc0] [debug] Cleaning up CryptoStream resources
[2024-12-28 01:52:50.100808] [0x00007f727aa09fc0] [debug] Cleaning up CryptoStream resources
[2024-12-28 01:52:50.100841] [0x00007f727aa09fc0] [info] Serialized large message frame, bytes written: 1048637
[2024-12-28 01:52:50.100841] [0x00007f727aa09fc0] [info] Serialized large message frame, bytes written: 1048637
[2024-12-28 01:52:50.100869] [0x00007f727aa09fc0] [info] Initializing CryptoStream
[2024-12-28 01:52:50.100869] [0x00007f727aa09fc0] [info] Initializing CryptoStream
[2024-12-28 01:52:50.100895] [0x00007f727aa09fc0] [debug] CryptoStream initialization complete
[2024-12-28 01:52:50.100895] [0x00007f727aa09fc0] [debug] CryptoStream initialization complete
[2024-12-28 01:52:50.100919] [0x00007f727aa09fc0] [info] Initializing crypto parameters
[2024-12-28 01:52:50.100919] [0x00007f727aa09fc0] [info] Initializing crypto parameters
[2024-12-28 01:52:50.100942] [0x00007f727aa09fc0] [debug] Crypto parameters initialized successfully
[2024-12-28 01:52:50.100942] [0x00007f727aa09fc0] [debug] Crypto parameters initialized successfully
[2024-12-28 01:52:50.100969] [0x00007f727aa09fc0] [info] Starting stream decryption
[2024-12-28 01:52:50.100969] [0x00007f727aa09fc0] [info] Starting stream decryption
[2024-12-28 01:52:50.100995] [0x00007f727aa09fc0] [debug] Initializing cipher for decryption
[2024-12-28 01:52:50.100995] [0x00007f727aa09fc0] [debug] Initializing cipher for decryption
[2024-12-28 01:52:50.101035] [0x00007f727aa09fc0] [debug] Cipher initialization complete
[2024-12-28 01:52:50.101035] [0x00007f727aa09fc0] [debug] Cipher initialization complete
[2024-12-28 01:52:50.101065] [0x00007f727aa09fc0] [info] Initializing CryptoStream
[2024-12-28 01:52:50.101065] [0x00007f727aa09fc0] [info] Initializing CryptoStream
[2024-12-28 01:52:50.101095] [0x00007f727aa09fc0] [debug] CryptoStream initialization complete
[2024-12-28 01:52:50.101095] [0x00007f727aa09fc0] [debug] CryptoStream initialization complete
[2024-12-28 01:52:50.101122] [0x00007f727aa09fc0] [info] Initializing crypto parameters
[2024-12-28 01:52:50.101122] [0x00007f727aa09fc0] [info] Initializing crypto parameters
[2024-12-28 01:52:50.101148] [0x00007f727aa09fc0] [debug] Crypto parameters initialized successfully
[2024-12-28 01:52:50.101148] [0x00007f727aa09fc0] [debug] Crypto parameters initialized successfully
[2024-12-28 01:52:50.102180] [0x00007f727aa09fc0] [info] Starting stream decryption
[2024-12-28 01:52:50.102180] [0x00007f727aa09fc0] [info] Starting stream decryption
[2024-12-28 01:52:50.102235] [0x00007f727aa09fc0] [debug] Initializing cipher for decryption
[2024-12-28 01:52:50.102235] [0x00007f727aa09fc0] [debug] Initializing cipher for decryption
[2024-12-28 01:52:50.102270] [0x00007f727aa09fc0] [debug] Cipher initialization complete
[2024-12-28 01:52:50.102270] [0x00007f727aa09fc0] [debug] Cipher initialization complete
[2024-12-28 01:52:50.103152] [0x00007f727aa09fc0] [error] Stream processing failed: Decryption error: Failed to finalize decryption
[2024-12-28 01:52:50.103152] [0x00007f727aa09fc0] [error] Stream processing failed: Decryption error: Failed to finalize decryption
[2024-12-28 01:52:50.103217] [0x00007f727aa09fc0] [debug] Cleaning up CryptoStream resources
[2024-12-28 01:52:50.103217] [0x00007f727aa09fc0] [debug] Cleaning up CryptoStream resources
[2024-12-28 01:52:50.103251] [0x00007f727aa09fc0] [debug] Cleaning up CryptoStream resources
[2024-12-28 01:52:50.103251] [0x00007f727aa09fc0] [debug] Cleaning up CryptoStream resources
unknown file: Failure
C++ exception with description "Decryption error: Failed to finalize decryption" thrown in the test body.

[2024-12-28 01:52:50.103686] [0x00007f727aa09fc0] [debug] Tearing down CodecTest fixture
[2024-12-28 01:52:50.103686] [0x00007f727aa09fc0] [debug] Tearing down CodecTest fixture
[  FAILED  ] CodecTest.LargeMessageHandling (17 ms)
[----------] 2 tests from CodecTest (31 ms total)

[----------] Global test environment tear-down
[==========] 19 tests from 3 test suites ran. (106 ms total)
[  PASSED  ] 17 tests.
[  FAILED  ] 2 tests, listed below:
[  FAILED  ] CodecTest.EncryptionVerification
[  FAILED  ] CodecTest.LargeMessageHandling
