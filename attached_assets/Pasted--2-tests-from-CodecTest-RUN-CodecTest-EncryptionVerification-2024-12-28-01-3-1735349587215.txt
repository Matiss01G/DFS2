[----------] 2 tests from CodecTest
[ RUN      ] CodecTest.EncryptionVerification
[2024-12-28 01:31:53.350014] [0x00007f276b836fc0] [info] Setting up CodecTest fixture
[2024-12-28 01:31:53.350072] [0x00007f276b836fc0] [debug] Test fixture initialized with key size: 32
[2024-12-28 01:31:53.350092] [0x00007f276b836fc0] [info] Starting EncryptionVerification test
[2024-12-28 01:31:53.350108] [0x00007f276b836fc0] [debug] Creating test frame with payload size: 14
[2024-12-28 01:31:53.350124] [0x00007f276b836fc0] [debug] Test frame created with type: 0
[2024-12-28 01:31:53.350141] [0x00007f276b836fc0] [info] Initializing CryptoStream
[2024-12-28 01:31:53.350359] [0x00007f276b836fc0] [debug] CryptoStream initialization complete
[2024-12-28 01:31:53.350883] [0x00007f276b836fc0] [info] Initializing crypto parameters
[2024-12-28 01:31:53.351030] [0x00007f276b836fc0] [debug] Crypto parameters initialized successfully
[2024-12-28 01:31:53.351191] [0x00007f276b836fc0] [info] Starting stream encryption
[2024-12-28 01:31:53.351347] [0x00007f276b836fc0] [debug] Initializing cipher for encryption
[2024-12-28 01:31:53.353608] [0x00007f276b836fc0] [debug] Cipher initialization complete
[2024-12-28 01:31:53.353987] [0x00007f276b836fc0] [info] Initializing CryptoStream
[2024-12-28 01:31:53.354277] [0x00007f276b836fc0] [debug] CryptoStream initialization complete
[2024-12-28 01:31:53.354687] [0x00007f276b836fc0] [info] Initializing crypto parameters
[2024-12-28 01:31:53.355123] [0x00007f276b836fc0] [debug] Crypto parameters initialized successfully
[2024-12-28 01:31:53.355688] [0x00007f276b836fc0] [info] Starting stream encryption
[2024-12-28 01:31:53.356003] [0x00007f276b836fc0] [debug] Initializing cipher for encryption
[2024-12-28 01:31:53.356387] [0x00007f276b836fc0] [debug] Cipher initialization complete
[2024-12-28 01:31:53.356766] [0x00007f276b836fc0] [debug] Cleaning up CryptoStream resources
[2024-12-28 01:31:53.357072] [0x00007f276b836fc0] [debug] Cleaning up CryptoStream resources
[2024-12-28 01:31:53.357456] [0x00007f276b836fc0] [debug] Serialized data size: 61
[2024-12-28 01:31:53.359808] [0x00007f276b836fc0] [debug] Verified sensitive data is not in plain text
[2024-12-28 01:31:53.360115] [0x00007f276b836fc0] [info] Initializing CryptoStream
[2024-12-28 01:31:53.360470] [0x00007f276b836fc0] [debug] CryptoStream initialization complete
[2024-12-28 01:31:53.360781] [0x00007f276b836fc0] [info] Initializing crypto parameters
[2024-12-28 01:31:53.361084] [0x00007f276b836fc0] [debug] Crypto parameters initialized successfully
[2024-12-28 01:31:53.361484] [0x00007f276b836fc0] [info] Starting stream decryption
[2024-12-28 01:31:53.361879] [0x00007f276b836fc0] [debug] Initializing cipher for decryption
[2024-12-28 01:31:53.362174] [0x00007f276b836fc0] [debug] Cipher initialization complete
[2024-12-28 01:31:53.362567] [0x00007f276b836fc0] [info] Initializing CryptoStream
[2024-12-28 01:31:53.362922] [0x00007f276b836fc0] [debug] CryptoStream initialization complete
[2024-12-28 01:31:53.363225] [0x00007f276b836fc0] [info] Initializing crypto parameters
[2024-12-28 01:31:53.363629] [0x00007f276b836fc0] [debug] Crypto parameters initialized successfully
[2024-12-28 01:31:53.363955] [0x00007f276b836fc0] [info] Starting stream decryption
[2024-12-28 01:31:53.364244] [0x00007f276b836fc0] [debug] Initializing cipher for decryption
[2024-12-28 01:31:53.364564] [0x00007f276b836fc0] [debug] Cipher initialization complete
[2024-12-28 01:31:53.365376] [0x00007f276b836fc0] [debug] Cleaning up CryptoStream resources
[2024-12-28 01:31:53.365589] [0x00007f276b836fc0] [debug] Added message frame to channel. Channel size: 1
[2024-12-28 01:31:53.365611] [0x00007f276b836fc0] [debug] Cleaning up CryptoStream resources
[2024-12-28 01:31:53.365626] [0x00007f276b836fc0] [debug] Recovered payload size: 14
/home/runner/StreamCryptoDFS/src/tests/codec_test.cpp:153: Failure
Expected equality of these values:
  recovered_payload
    Which is: "\0\0\0\0\0\0\0\0\0\0\0\0\0\0"
  "Sensitive Data"

[2024-12-28 01:31:53.367250] [0x00007f276b836fc0] [info] EncryptionVerification test completed successfully
[2024-12-28 01:31:53.367517] [0x00007f276b836fc0] [debug] Tearing down CodecTest fixture
[  FAILED  ] CodecTest.EncryptionVerification (17 ms)
[ RUN      ] CodecTest.LargeMessageHandling
[2024-12-28 01:31:53.367999] [0x00007f276b836fc0] [info] Setting up CodecTest fixture
[2024-12-28 01:31:53.367999] [0x00007f276b836fc0] [info] Setting up CodecTest fixture
[2024-12-28 01:31:53.368328] [0x00007f276b836fc0] [debug] Test fixture initialized with key size: 32
[2024-12-28 01:31:53.368328] [0x00007f276b836fc0] [debug] Test fixture initialized with key size: 32
[2024-12-28 01:31:53.368701] [0x00007f276b836fc0] [info] Starting LargeMessageHandling test
[2024-12-28 01:31:53.368701] [0x00007f276b836fc0] [info] Starting LargeMessageHandling test
[2024-12-28 01:31:53.371702] [0x00007f276b836fc0] [debug] Created large payload of size: 1048576
[2024-12-28 01:31:53.371702] [0x00007f276b836fc0] [debug] Created large payload of size: 1048576
[2024-12-28 01:31:53.372448] [0x00007f276b836fc0] [debug] Creating test frame with payload size: 1048576
[2024-12-28 01:31:53.372448] [0x00007f276b836fc0] [debug] Creating test frame with payload size: 1048576
[2024-12-28 01:31:53.373707] [0x00007f276b836fc0] [debug] Test frame created with type: 0
[2024-12-28 01:31:53.373707] [0x00007f276b836fc0] [debug] Test frame created with type: 0
[2024-12-28 01:31:53.374420] [0x00007f276b836fc0] [info] Initializing CryptoStream
[2024-12-28 01:31:53.374420] [0x00007f276b836fc0] [info] Initializing CryptoStream
[2024-12-28 01:31:53.374979] [0x00007f276b836fc0] [debug] CryptoStream initialization complete
[2024-12-28 01:31:53.374979] [0x00007f276b836fc0] [debug] CryptoStream initialization complete
[2024-12-28 01:31:53.375670] [0x00007f276b836fc0] [info] Initializing crypto parameters
[2024-12-28 01:31:53.375670] [0x00007f276b836fc0] [info] Initializing crypto parameters
[2024-12-28 01:31:53.380483] [0x00007f276b836fc0] [debug] Crypto parameters initialized successfully
[2024-12-28 01:31:53.380483] [0x00007f276b836fc0] [debug] Crypto parameters initialized successfully
[2024-12-28 01:31:53.381107] [0x00007f276b836fc0] [info] Starting stream encryption
[2024-12-28 01:31:53.381107] [0x00007f276b836fc0] [info] Starting stream encryption
[2024-12-28 01:31:53.381844] [0x00007f276b836fc0] [debug] Initializing cipher for encryption
[2024-12-28 01:31:53.381844] [0x00007f276b836fc0] [debug] Initializing cipher for encryption
[2024-12-28 01:31:53.382674] [0x00007f276b836fc0] [debug] Cipher initialization complete
[2024-12-28 01:31:53.382674] [0x00007f276b836fc0] [debug] Cipher initialization complete
[2024-12-28 01:31:53.383924] [0x00007f276b836fc0] [info] Initializing CryptoStream
[2024-12-28 01:31:53.383924] [0x00007f276b836fc0] [info] Initializing CryptoStream
[2024-12-28 01:31:53.384616] [0x00007f276b836fc0] [debug] CryptoStream initialization complete
[2024-12-28 01:31:53.384616] [0x00007f276b836fc0] [debug] CryptoStream initialization complete
[2024-12-28 01:31:53.385160] [0x00007f276b836fc0] [info] Initializing crypto parameters
[2024-12-28 01:31:53.385160] [0x00007f276b836fc0] [info] Initializing crypto parameters
[2024-12-28 01:31:53.385897] [0x00007f276b836fc0] [debug] Crypto parameters initialized successfully
[2024-12-28 01:31:53.385897] [0x00007f276b836fc0] [debug] Crypto parameters initialized successfully
[2024-12-28 01:31:53.387769] [0x00007f276b836fc0] [info] Starting stream encryption
[2024-12-28 01:31:53.387769] [0x00007f276b836fc0] [info] Starting stream encryption
[2024-12-28 01:31:53.388547] [0x00007f276b836fc0] [debug] Initializing cipher for encryption
[2024-12-28 01:31:53.388547] [0x00007f276b836fc0] [debug] Initializing cipher for encryption
[2024-12-28 01:31:53.389119] [0x00007f276b836fc0] [debug] Cipher initialization complete
[2024-12-28 01:31:53.389119] [0x00007f276b836fc0] [debug] Cipher initialization complete
[2024-12-28 01:31:53.395178] [0x00007f276b836fc0] [debug] Cleaning up CryptoStream resources
[2024-12-28 01:31:53.395178] [0x00007f276b836fc0] [debug] Cleaning up CryptoStream resources
[2024-12-28 01:31:53.396236] [0x00007f276b836fc0] [debug] Cleaning up CryptoStream resources
[2024-12-28 01:31:53.396236] [0x00007f276b836fc0] [debug] Cleaning up CryptoStream resources
[2024-12-28 01:31:53.396960] [0x00007f276b836fc0] [info] Serialized large message frame, bytes written: 1048637
[2024-12-28 01:31:53.396960] [0x00007f276b836fc0] [info] Serialized large message frame, bytes written: 1048637
[2024-12-28 01:31:53.397637] [0x00007f276b836fc0] [info] Initializing CryptoStream
[2024-12-28 01:31:53.397637] [0x00007f276b836fc0] [info] Initializing CryptoStream
[2024-12-28 01:31:53.398395] [0x00007f276b836fc0] [debug] CryptoStream initialization complete
[2024-12-28 01:31:53.398395] [0x00007f276b836fc0] [debug] CryptoStream initialization complete
[2024-12-28 01:31:53.398951] [0x00007f276b836fc0] [info] Initializing crypto parameters
[2024-12-28 01:31:53.398951] [0x00007f276b836fc0] [info] Initializing crypto parameters
[2024-12-28 01:31:53.399622] [0x00007f276b836fc0] [debug] Crypto parameters initialized successfully
[2024-12-28 01:31:53.399622] [0x00007f276b836fc0] [debug] Crypto parameters initialized successfully
[2024-12-28 01:31:53.400168] [0x00007f276b836fc0] [info] Starting stream decryption
[2024-12-28 01:31:53.400168] [0x00007f276b836fc0] [info] Starting stream decryption
[2024-12-28 01:31:53.400774] [0x00007f276b836fc0] [debug] Initializing cipher for decryption
[2024-12-28 01:31:53.400774] [0x00007f276b836fc0] [debug] Initializing cipher for decryption
[2024-12-28 01:31:53.401395] [0x00007f276b836fc0] [debug] Cipher initialization complete
[2024-12-28 01:31:53.401395] [0x00007f276b836fc0] [debug] Cipher initialization complete
[2024-12-28 01:31:53.402241] [0x00007f276b836fc0] [info] Initializing CryptoStream
[2024-12-28 01:31:53.402241] [0x00007f276b836fc0] [info] Initializing CryptoStream
[2024-12-28 01:31:53.402274] [0x00007f276b836fc0] [debug] CryptoStream initialization complete
[2024-12-28 01:31:53.402274] [0x00007f276b836fc0] [debug] CryptoStream initialization complete
[2024-12-28 01:31:53.402316] [0x00007f276b836fc0] [info] Initializing crypto parameters
[2024-12-28 01:31:53.402316] [0x00007f276b836fc0] [info] Initializing crypto parameters
[2024-12-28 01:31:53.402346] [0x00007f276b836fc0] [debug] Crypto parameters initialized successfully
[2024-12-28 01:31:53.402346] [0x00007f276b836fc0] [debug] Crypto parameters initialized successfully
[2024-12-28 01:31:53.403503] [0x00007f276b836fc0] [info] Starting stream decryption
[2024-12-28 01:31:53.403503] [0x00007f276b836fc0] [info] Starting stream decryption
[2024-12-28 01:31:53.403578] [0x00007f276b836fc0] [debug] Initializing cipher for decryption
[2024-12-28 01:31:53.403578] [0x00007f276b836fc0] [debug] Initializing cipher for decryption
[2024-12-28 01:31:53.403618] [0x00007f276b836fc0] [debug] Cipher initialization complete
[2024-12-28 01:31:53.403618] [0x00007f276b836fc0] [debug] Cipher initialization complete
[2024-12-28 01:31:53.405014] [0x00007f276b836fc0] [error] Stream processing failed: Decryption error: Failed to finalize decryption
[2024-12-28 01:31:53.405014] [0x00007f276b836fc0] [error] Stream processing failed: Decryption error: Failed to finalize decryption
[2024-12-28 01:31:53.405128] [0x00007f276b836fc0] [debug] Cleaning up CryptoStream resources
[2024-12-28 01:31:53.405128] [0x00007f276b836fc0] [debug] Cleaning up CryptoStream resources
[2024-12-28 01:31:53.405165] [0x00007f276b836fc0] [debug] Cleaning up CryptoStream resources
[2024-12-28 01:31:53.405165] [0x00007f276b836fc0] [debug] Cleaning up CryptoStream resources
unknown file: Failure
C++ exception with description "Decryption error: Failed to finalize decryption" thrown in the test body.

[2024-12-28 01:31:53.405584] [0x00007f276b836fc0] [debug] Tearing down CodecTest fixture
[2024-12-28 01:31:53.405584] [0x00007f276b836fc0] [debug] Tearing down CodecTest fixture
[  FAILED  ] CodecTest.LargeMessageHandling (37 ms)
[----------] 2 tests from CodecTest (55 ms total)

[----------] Global test environment tear-down
[==========] 19 tests from 3 test suites ran. (138 ms total)
[  PASSED  ] 17 tests.
[  FAILED  ] 2 tests, listed below:
[  FAILED  ] CodecTest.EncryptionVerification
[  FAILED  ] CodecTest.LargeMessageHandling